# üè• NEURAUDIT COLOMBIA - MEMORIA DEL PROYECTO

## üìã INFORMACI√ìN GENERAL

**Proyecto:** NeurAudit Colombia - Sistema de Auditor√≠a M√©dica EPS Familiar de Colombia  
**Cliente:** EPS Familiar de Colombia  
**Desarrollador:** Anal√≠tica Neuronal  
**Inicio:** 29 Julio 2025  
**Estado:** En desarrollo  

## üéØ OBJETIVO PRINCIPAL

Desarrollar un aplicativo web para la radicaci√≥n, auditor√≠a, glosas y conciliaci√≥n de cuentas m√©dicas entre PSS/PTS y EPS Familiar de Colombia, cumpliendo estrictamente con la **Resoluci√≥n 2284 de 2023** del Ministerio de Salud y Protecci√≥n Social.

## üö® L√çNEAS ROJAS APRENDIDAS DE MEDISPENSA

### üíÄ CAT√ÅSTROFES HIST√ìRICAS QUE NUNCA DEBEN REPETIRSE:

#### üö´ **ERROR CR√çTICO 405 - Method Not Allowed**
- **Problema:** Backend endpoint `/api/eps-users/search/` SOLO acepta POST
- **Error:** Si se env√≠a GET ‚Üí Error 405 Method Not Allowed
- **Impacto:** B√∫squedas de usuarios completamente rotas

#### üóÑÔ∏è **ERRORES DE SERIALIZACI√ìN MongoDB-Django**
- **Problema Cr√≠tico:** Django REST Framework no puede serializar ObjectId de MongoDB directamente
- **Error T√≠pico:** `TypeError: int() argument must be string, not 'ObjectId'`
- **Causa:** Falta de declaraci√≥n expl√≠cita del campo id en serializers

#### üêõ **ERROR "undefined reading properties"**  
- **Problema:** Errores sistem√°ticos al acceder propiedades de respuestas API indefinidas
- **S√≠ntoma:** `Cannot read properties of undefined (reading 'results')`
- **Causa:** No validar respuestas de API antes de acceder a propiedades

### ‚ùå NUNCA HACER:
1. **NO cambiar c√≥digo sin consulta y explicaci√≥n**
2. **NO tocar/borrar bases de datos MongoDB de producci√≥n**  
3. **NO cambiar a SQL - IMPERATIVO: Solo MongoDB**
4. **NO hacer "mejoras" no solicitadas**
5. **NO romper funcionalidad existente**
6. **NO enviar m√©todos HTTP incorrectos a endpoints**
7. **NO ejecutar comandos Django sin activar entorno virtual**
8. **NO usar puertos diferentes (Backend 8003)**
9. **NO usar otro sistema que no sea MongoDB + ObjectIdAutoField**

### ‚úÖ SIEMPRE HACER:
1. **Leer archivo completo antes de editar**
2. **Preguntar antes de cambios estructurales**
3. **Mantener consistencia con arquitectura existente**
4. **Documentar cambios importantes**
5. **Validar respuestas de API antes de acceder a propiedades**
6. **Declarar expl√≠citamente campo id en todos los serializers MongoDB**
7. **Verificar m√©todos HTTP requeridos por endpoints**
8. **Hacer backup antes de cambios cr√≠ticos**
9. **Implementar logs de debug para diagnosticar problemas**
10. **ACTIVAR ENTORNO VIRTUAL antes de cualquier comando Django**
11. **USAR SIEMPRE ObjectIdAutoField para primary keys**
12. **MANTENER enfoque NoSQL con MongoDB exclusivamente**
13. **MANTENER puertos fijos: Backend 8003**

## üèóÔ∏è ARQUITECTURA T√âCNICA

### **Stack Tecnol√≥gico:**
- **Backend:** Django 5.2.4 + Django REST Framework + MongoDB
- **Base de Datos:** MongoDB - `neuraudit_colombia_db`
- **Autenticaci√≥n:** JWT con sistema personalizado 100% MongoDB
- **Storage:** Digital Ocean Spaces Object Storage
- **Puertos:** Backend 8003

### **Estructura del Proyecto:**
```
/home/adrian_carvajal/Anal√≠¬Æ/neuraudit/
‚îú‚îÄ‚îÄ backend/     # Django Backend
‚îú‚îÄ‚îÄ context/     # Documentaci√≥n y contexto
‚îî‚îÄ‚îÄ CLAUDE.md    # Memoria del proyecto
```

## üìä FLUJO DE TRABAJO SEG√öN RESOLUCI√ìN 2284

### **Proceso Principal:**
1. **PSS Radica** ‚Üí Cuenta m√©dica + RIPS + Soportes (22 d√≠as h√°biles)
2. **Sistema Valida** ‚Üí Genera devoluciones autom√°ticas si aplica (5 d√≠as)
3. **EPS Audita** ‚Üí Asignaci√≥n autom√°tica equitativa por perfiles
4. **Genera Glosas** ‚Üí Seg√∫n codificaci√≥n est√°ndar (causales taxativas)
5. **PSS Responde** ‚Üí A glosas en plazos legales (5 d√≠as)
6. **Conciliaci√≥n** ‚Üí Si no hay acuerdo entre partes
7. **Pago** ‚Üí Tras conciliaci√≥n exitosa

## üë• USUARIOS Y ROLES

### **PSS/PTS (Prestadores):**
- **Radicador**: Radica cuentas m√©dicas con soportes
- Autenticaci√≥n: NIT + Usuario + Contrase√±a

### **EPS Familiar de Colombia:**
- **Auditor M√©dico**: Auditor√≠a de pertinencia cl√≠nica
- **Auditor Administrativo**: Auditor√≠a de facturaci√≥n/soportes  
- **Coordinador de Auditor√≠a**: Supervisi√≥n y asignaci√≥n
- **Conciliador**: Gesti√≥n de conciliaciones
- **Contabilidad**: Exportaci√≥n y reportes financieros
- **Administrador**: Gesti√≥n completa del sistema

## üìã M√ìDULOS PRINCIPALES - VERSI√ìN 1

### ‚úÖ **M√≥dulos Prioritarios:**
1. **üî∏ Radicaci√≥n** - Upload de facturas, RIPS y soportes
2. **üî∏ Devoluciones** - Sistema autom√°tico seg√∫n causales normativas
3. **üî∏ Asignaci√≥n** - Distribuci√≥n autom√°tica equitativa a auditores
4. **üî∏ Auditor√≠a** - Revisi√≥n m√©dica y administrativa con glosas
5. **üî∏ Glosas** - Codificaci√≥n est√°ndar seg√∫n resoluci√≥n
6. **üî∏ Respuestas** - Portal PSS para responder glosas
7. **üî∏ Conciliaci√≥n** - Gesti√≥n de acuerdos entre partes
8. **üî∏ Pago** - Autorizaci√≥n y registro de pagos

### üîÑ **M√≥dulos Secundarios:**
- Dashboard ejecutivo con KPIs
- Alertas autom√°ticas por plazos
- Exportaci√≥n contable/financiera
- Sistema de trazabilidad transaccional
- Portal consulta estado cuentas PSS

## üìÅ SOPORTES SEG√öN RESOLUCI√ìN 2284

### **Obligatorios:**
- **Factura electr√≥nica** (XML DIAN + MinSalud)
- **RIPS validado** (JSON con c√≥digo √∫nico MinSalud)

### **Por Tipo de Servicio:**
- **Ambulatoria**: Resumen atenci√≥n + Orden/prescripci√≥n
- **Urgencias**: Hoja urgencia/epicrisis + Medicamentos + Diagn√≥sticos
- **Hospitalizaci√≥n**: Epicrisis + Descripci√≥n quir√∫rgica + Anestesia
- **Medicamentos**: Prescripci√≥n + Comprobante recibido
- **Transporte**: Hoja traslado + Orden

## ‚è∞ PLAZOS LEGALES CR√çTICOS

- **Radicaci√≥n soportes**: 22 d√≠as h√°biles desde expedici√≥n factura
- **Devoluci√≥n EPS**: 5 d√≠as h√°biles desde radicaci√≥n  
- **Respuesta PSS a devoluci√≥n**: 5 d√≠as h√°biles
- **Formulaci√≥n glosas**: Seg√∫n Art. 57 Ley 1438/2011
- **Respuesta PSS a glosas**: 5 d√≠as h√°biles
- **Pago primer 50%**: 5 d√≠as despu√©s presentaci√≥n (modalidad evento)

## üîß CODIFICACI√ìN EST√ÅNDAR

### **Glosas (6 d√≠gitos: AA0000):**
- **FA**: Facturaci√≥n (diferencias cantidades/valores)
- **TA**: Tarifas (diferencias valores pactados)  
- **SO**: Soportes (ausencia/inconsistencia documentos)
- **AU**: Autorizaciones (servicios no autorizados)
- **CO**: Cobertura (servicios no incluidos)
- **CL**: Calidad (pertinencia m√©dica)
- **SA**: Seguimiento acuerdos (incumplimiento indicadores)

### **Devoluciones:**
- **DE16**: Persona corresponde a otro responsable pago
- **DE44**: Prestador no hace parte red integral
- **DE50**: Factura ya pagada o en tr√°mite
- **DE56**: No radicaci√≥n soportes dentro 22 d√≠as h√°biles

## üìä KPIs PRINCIPALES

### **Indicadores con Valores Monetarios:**
- Tasa de glosas por auditor/PSS (% y $)
- Tiempos promedio de respuesta (d√≠as y impacto $)
- Valor glosas aceptadas vs rechazadas ($)
- Estado cartera por antig√ºedad ($ por per√≠odos)
- Estados de cartera ($)
- Conciliaciones bancarias ($)
- Informes de glosas ($)
- An√°lisis de recaudo ($)

## üîê SEGURIDAD Y COMPLIANCE

- **Auditor√≠a detallada**: Registro completo todas las acciones
- **Protecci√≥n datos salud**: Cumplimiento normativo HABEAS DATA
- **Backup y DR**: Recuperaci√≥n ante desastres
- **Trazabilidad transaccional**: Registro autom√°tico en l√≠nea
- **Autenticaci√≥n robusta**: NIT + Usuario + Contrase√±a

## üíæ ALMACENAMIENTO

- **Base de datos**: MongoDB `neuraudit_colombia_db`
- **Documentos**: Digital Ocean Spaces Object Storage
- **Tama√±o m√°ximo**: Seg√∫n norma (1GB por transacci√≥n)
- **Formatos**: PDF editable (300 dpi), JSON (RIPS), XML (Factura)

## üìà DATOS INICIALES

### **Cat√°logos a Importar:**
- **Tarifarios**: Excel desde EPS (ISS 2001 m√≠nimo, SOAT 2025 m√°ximo)
- **CUPS/CUM**: Actualizado (suministrado posteriormente)
- **PSS Habilitados**: 58,000 en el pa√≠s (suministrado posteriormente)
- **Datos hist√≥ricos**: CSV (suministrado posteriormente)

## üöÄ NOTIFICACIONES

- **En plataforma**: Alertas tiempo real
- **Email**: Notificaciones cr√≠ticas
- **Tipos**: Vencimiento plazos, aceptaciones t√°citas, facturas pr√≥ximas vencer

## üîÑ INTEGRACIONES

### **APIs Externas:**
- **MinSalud**: Validaci√≥n RIPS (Docker API - pendiente desarrollo)
- **DIAN**: Validaci√≥n facturas electr√≥nicas
- **Digital Ocean**: Spaces Object Storage

### **Exportaciones:**
- **Excel/CSV**: Reportes est√°ndar
- **API**: Interoperabilidad con software contable externo
- **JSON**: Datos estructurados para terceros

## üìã ESTADO ACTUAL (30 Julio 2025)
- **Fase**: ‚úÖ **SISTEMA BACKEND 100% FUNCIONAL Y TESTING COMPLETO**
- **Avance**: Backend Django + JWT + MongoDB = **FUNCIONANDO TOTALMENTE**
- **Testing**: ‚úÖ Usuarios EPS y PSS probados exitosamente
- **Credenciales**: test.eps/simple123 (EPS) y test.pss/simple123 (PSS con NIT: 123456789-0)
- **Backup Final**: `backend-backup-testing-final-20250730/`
- **Documentaci√≥n**: `NEURAUDIT-AUTHENTICATION-JWT-DOCUMENTATION.md`
- **Login**: ‚úÖ PSS (NIT+Usuario) y EPS (Usuario) **FUNCIONANDO**
- **JWT**: ‚úÖ Tokens, validaci√≥n, logout **FUNCIONANDO**
- **Logs**: ‚úÖ Sistema de auditor√≠a completo registrando todas las actividades
- **Nueva Radicaci√≥n**: ‚úÖ Extracci√≥n XML/RIPS, m√∫ltiples usuarios, anti-cruces con NIT
- **Consulta Radicaciones**: ‚úÖ Datos reales MongoDB, NIT visible, estad√≠sticas, filtros

## üîß COMANDOS CR√çTICOS PARA FUTURAS SESIONES

### ‚ö° **ACTIVACI√ìN ENTORNO VIRTUAL - OBLIGATORIO**
```bash
# SIEMPRE ejecutar ANTES de cualquier comando Django:
cd /home/adrian_carvajal/Anal√≠¬Æ/neuraudit/backend
source venv/bin/activate

# Verificar activaci√≥n (debe mostrar "(venv)"):
which python
```

### üöÄ **COMANDOS DE INICIO - PUERTOS FIJOS**
```bash
# Backend Django (Puerto 8003 FIJO):
cd /home/adrian_carvajal/Anal√≠¬Æ/neuraudit/backend
source venv/bin/activate
python manage.py runserver 0.0.0.0:8003
```

### üèóÔ∏è **COMANDOS DJANGO DEVELOPMENT**
```bash
# Crear migraciones (SIEMPRE con venv activo):
source venv/bin/activate
python manage.py makemigrations

# Aplicar migraciones:
python manage.py migrate

# Crear usuarios de prueba:
python manage.py create_test_users

# Crear prestadores de prueba:
python manage.py create_test_prestadores

# Shell Django:
python manage.py shell
```


---

**üè• Desarrollado por Anal√≠tica Neuronal para EPS Familiar de Colombia**  
**üìÖ Fecha inicio:** 29 Julio 2025  
**üéØ Estado:** En desarrollo  
**üìã Versi√≥n documento:** 1.1 - Actualizada 31 Julio 2025  

---

## üÜï ACTUALIZACIONES RECIENTES (1 Agosto 2025)

### ‚úÖ **M√ìDULO DE CONCILIACI√ìN - SISTEMA DE RATIFICACI√ìN COMPLETO:**

#### **üéØ Funcionalidad Principal Implementada:**
- **Ratificaci√≥n Individual**: Confirmar glosas espec√≠ficas
- **Levantamiento Individual**: Anular glosas con justificaci√≥n obligatoria  
- **Acciones Masivas**: Ratificar/Levantar todas las glosas pendientes de una vez
- **Validaciones Completas**: Estados, permisos, confirmaciones, justificaciones
- **Integraci√≥n Backend**: API endpoints para procesar decisiones de conciliaci√≥n

#### **üîß Errores Cr√≠ticos Solucionados:**
- **Error prestador_info undefined**: Solucionado agregando campos completos en list serializer
- **Error MultipleObjectsReturned**: Solucionado manejando casos duplicados por fecha m√°s reciente
- **Error 400 Bad Request**: Solucionado en endpoint obtener_o_crear_caso

#### **üìä Backend NoSQL Optimizado:**
- **Serializers Mejorados**: `CasoConciliacionListSerializer` con datos completos
- **Endpoint Ratificaci√≥n**: `POST /api/conciliacion/casos/{id}/procesar_decision/`
- **Manejo de Estados**: PENDIENTE ‚Üí RATIFICADA/LEVANTADA
- **Trazabilidad**: Registro completo de decisiones con usuario y fecha

#### **üìÅ Documentaci√≥n y Estado:**
- **Documentaci√≥n completa:** `NEURAUDIT-CONCILIACION-RATIFICACION-COMPLETE-DOCUMENTATION.md`
- **Backup Backend:** `backend-backup-conciliacion-ratificacion-complete-20250731-2136/`
- **Estado:** ‚úÖ Sistema backend 100% funcional, listo para producci√≥n

#### **üîÑ Flujo de Trabajo Conciliador:**
1. **Acceder**: Dashboard ‚Üí Conciliaci√≥n ‚Üí Ver Detalles
2. **Revisar**: Tab "Glosas Aplicadas" con todas las glosas y estados
3. **Decidir Individual**: Botones ‚úÖ Ratificar / ‚ùå Levantar por glosa
4. **Decidir Masivo**: Botones de acci√≥n masiva para m√∫ltiples glosas
5. **Confirmar**: Validaciones con valores, justificaciones obligatorias
6. **Seguimiento**: Actualizaci√≥n inmediata de valores financieros

#### **üí∞ Impacto Financiero Autom√°tico:**
- **Valor Ratificado**: Se incrementa autom√°ticamente al ratificar
- **Valor Levantado**: Se incrementa autom√°ticamente al levantar  
- **Valor en Disputa**: Se reduce autom√°ticamente con cada decisi√≥n
- **Resumen Visual**: Gr√°fico circular actualizado en tiempo real

### **üìã Archivos Principales Modificados:**
```
‚úÖ BACKEND:
   /apps/conciliacion/views.py (manejo MultipleObjectsReturned)
   /apps/conciliacion/serializers.py (prestador_info en ListSerializer)
```

---

## üÜï ACTUALIZACIONES RECIENTES (31 Julio 2025)

### ‚úÖ **M√ìDULO AUDITOR√çA M√âDICA - COMPLETAMENTE FUNCIONAL:**

#### üìä **Funcionalidad Implementada:**
- **Navegaci√≥n de 3 niveles**: Radicaciones ‚Üí Facturas ‚Üí Servicios
- **Sistema de glosas oficial**: Todos los c√≥digos de la Resoluci√≥n 2284 de 2023
- **Separaci√≥n clara**: GLOSAS las aplica el AUDITOR, RESPUESTAS las da el PRESTADOR

#### üìÅ **Backend Implementado:**
- **Nuevos modelos en auditoria app** (sin tocar radicacion):
  - `FacturaRadicada` - Con contadores y valores por tipo de servicio
  - `ServicioFacturado` - Con soporte para glosas

#### üìã **C√≥digos de Glosas Implementados:**
- **FA - Facturaci√≥n**: 59 c√≥digos espec√≠ficos
- **TA - Tarifas**: 16 c√≥digos espec√≠ficos  
- **SO - Soportes**: 68 c√≥digos espec√≠ficos
- **AU - Autorizaciones**: 29 c√≥digos espec√≠ficos
- **CO - Cobertura**: 14 c√≥digos espec√≠ficos
- **CL - Calidad**: 14 c√≥digos espec√≠ficos
- **SA - Seguimiento Acuerdos**: 8 c√≥digos espec√≠ficos

#### üìÇ **Documentaci√≥n y Backups:**
- **Documentaci√≥n completa:** `NEURAUDIT-AUDITORIA-MODULE-COMPLETE-DOCUMENTATION.md`
- **Backup Backend:** `backend-backup-auditoria-glosas-complete-20250731-1016/`

### ‚úÖ **M√ìDULO CONTRATACI√ìN - COMPLETAMENTE FUNCIONAL:**

#### üìä **Backend Implementado:**
- **ViewSets completos** con `permission_classes = [AllowAny]` para desarrollo
- **Endpoints RESTful** para Prestadores, Contratos, Tarifarios (CUPS/Medicamentos/Dispositivos)
- **Estad√≠sticas din√°micas** con c√°lculos de porcentajes reales
- **Comandos de datos de prueba** creando 6 prestadores, 6 contratos, 14 tarifarios CUPS
- **Validaci√≥n de tarifas** para auditor√≠a m√©dica


#### üìÅ **Documentaci√≥n y Backups:**
- **Documentaci√≥n completa:** `NEURAUDIT-CONTRATACION-MODULE-COMPLETE-DOCUMENTATION.md`
- **Backup Backend:** `backend-backup-contratacion-complete-20250730-1948/`

### üìÇ **ARCHIVOS CR√çTICOS MODIFICADOS HOY:**
```
‚úÖ BACKEND:
   /backend/apps/contratacion/views.py
   ‚Ü≥ Agregado permission_classes = [AllowAny] a todos los ViewSets
   ‚Ü≥ Endpoint estad√≠sticas prestadores con c√°lculos de porcentajes
   ‚Ü≥ Endpoint estad√≠sticas contratos con porcentaje capitaci√≥n

   /backend/apps/contratacion/management/commands/
   ‚Ü≥ create_test_prestadores.py (creado)
   ‚Ü≥ create_test_contratos.py (creado)  
   ‚Ü≥ setup_contratacion_test_data.py (creado)
```


---

## üö® SOLUCI√ìN CR√çTICA: SERIALIZACI√ìN ObjectId EN CONTRATACI√ìN (31 Julio 2025)

### **üíÄ Problema Catastr√≥fico:**
- **Error 500** en todos los endpoints de contrataci√≥n
- `TypeError: Object of type ObjectId is not JSON serializable`
- Afectaba: prestadores, contratos, modalidades, tarifarios

### **‚úÖ Soluci√≥n Implementada:**

#### 1. **Renderer Personalizado** (`/backend/apps/contratacion/renderers.py`):
```python
class MongoJSONRenderer(JSONRenderer):
    """Maneja serializaci√≥n de ObjectId MongoDB"""
    def render(self, data, accepted_media_type=None, renderer_context=None):
        return json.dumps(data, cls=MongoJSONEncoder, ...).encode('utf-8')

class MongoJSONEncoder(json.JSONEncoder):
    def default(self, obj):
        if isinstance(obj, ObjectId):
            return str(obj)  # Convierte ObjectId a string
        return super().default(obj)
```

#### 2. **ViewSets Actualizados** (TODOS en contrataci√≥n):
```python
class PrestadorViewSet(viewsets.ModelViewSet):
    renderer_classes = [MongoJSONRenderer]  # ‚Üê CR√çTICO
    # ... resto de configuraci√≥n
```

#### 3. **Serializers Corregidos**:
```python
# ANTES (MAL):
id = serializers.CharField(read_only=True)

# DESPU√âS (BIEN):
id = serializers.ReadOnlyField()
```

#### 4. **Filtros ForeignKey Corregidos**:
```python
# ANTES (error despu√©s de cambio a ForeignKey):
filter(modalidad_principal='CAPITACION')

# DESPU√âS (correcto):
filter(modalidad_principal__codigo='CAPITACION')
```

### **‚ö†Ô∏è ADVERTENCIAS CR√çTICAS:**
1. **NO aplicar encoder globalmente** - Afectar√≠a otros m√≥dulos
2. **NO usar CharField para campos id** en serializers MongoDB
3. **NO eliminar renderer_classes** de los ViewSets
4. **NO revertir migraci√≥n** 0002_convert_modalidad_to_fk

### **üìÅ Documentaci√≥n Completa:**
- `/backend/apps/contratacion/MONGODB_OBJECTID_SERIALIZATION_FIX.md`

---

## ‚ö†Ô∏è RECORDATORIOS IMPORTANTES

1. **NUNCA modificar funcionalidad sin consultar**
2. **SIEMPRE seguir patrones de Medispensa**
3. **CUMPLIR estrictamente Resoluci√≥n 2284 de 2023**
4. **MANTENER trazabilidad completa**
5. **VALIDAR plazos legales en todo momento**


---

## üÜï M√ìDULO DE AUDITOR√çA - COMPLETAMENTE IMPLEMENTADO (31 Julio 2025)

### ‚úÖ **Backend Auditor√≠a M√©dica:**

#### üìÅ **Modelos Backend Preparados:**
```python
# /backend/apps/auditoria/models_facturas.py
- FacturaRadicada: Facturas dentro de radicaci√≥n
- ServicioFacturado: Servicios con tipos espec√≠ficos

# /backend/apps/radicacion/models_auditoria.py (existente)
- PreGlosa: Pre-glosas autom√°ticas
- GlosaOficial: Glosas aprobadas por auditor
- AsignacionAuditoria: Distribuci√≥n equitativa
- TrazabilidadAuditoria: Log completo
```

#### üîÑ **Flujo Implementado:**
1. Auditor ve radicaciones pendientes ‚Üí 2. Selecciona radicaci√≥n ‚Üí 3. Ve facturas ‚Üí 4. Audita servicios ‚Üí 5. Aplica glosas con c√≥digos oficiales ‚Üí 6. Finaliza auditor√≠a

#### üîê **Roles Clarificados:**
- **Auditor (EPS)**: APLICA las glosas a los servicios
- **Prestador (PSS)**: RESPONDE a las glosas (5 d√≠as h√°biles)

### üìÅ **Documentaci√≥n y Estado:**
- **Documentaci√≥n completa:** `NEURAUDIT-AUDITORIA-MODULE-COMPLETE-DOCUMENTATION.md`
- **Estado:** ‚úÖ Backend 100% implementado